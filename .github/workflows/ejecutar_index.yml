name: Flujo seguimiento Stage 1 y Stage 2

on:
  schedule:
    # Todos los jueves a las 10:00 hora de España (CET/CEST)
    - cron: "0 8 * * 4" # 8:00 UTC = 10:00 CET/CEST
  workflow_dispatch:

jobs:
  run-index:
    runs-on: ubuntu-latest
    env:
      NOTION_TOKEN: ${{ secrets.NOTION_TOKEN }}
      NOTION_DATABASE_ID: ${{ secrets.NOTION_DATABASE_ID }}
      ZAPIER_WEBHOOK_URL: ${{ secrets.ZAPIER_WEBHOOK_URL }}

    steps:
      - name: Checkout código
        uses: actions/checkout@v3

      - name: Configurar Node.js
        uses: actions/setup-node@v3
        with:
          node-version: "20"

      - name: Instalar dependencias
        run: npm install

      - name: Ejecutar index.js
        run: node index.js
